---
export const prerender = false 
import useStrapi from "@/utils/strapi"
import GenericLayout from "@/layouts/generic.astro"
import DynamicZone from "@/components/dynamicZone/index.astro"

const { slug } = Astro.params

const response = await useStrapi.collection('pages').find({
    filters: {
        slug: {
            $eq: slug
        }
    }, 
    populate: {
    composites: {
      on: {
        'composites.hero': {
          populate: "*",
        },
        'composites.cta-section': {
          populate: "*",
        },
        'composites.generic-content': {
          populate: "*",
        },
        'composites.accordions': {
          populate: "*",
        },
        'composites.contact-form': {
          populate: "*",
        },
        'composites.testimonials': {
          populate: "*", 
        },
        'composites.card-display': {
          populate: { 
            'cards': {
              populate: "*"
            }, 
          }
        }
      },
    },
  },
})

const data = response.data[0]

console.log(data)

---

<GenericLayout>
    <DynamicZone composites={ data?.composites}/>
</GenericLayout>